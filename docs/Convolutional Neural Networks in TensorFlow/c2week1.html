<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tensorflowing - W1:Exploring a Larger Dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../logo.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../1.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Tensorflowing</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Intro</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-intro">    
        <li class="dropdown-header">Intro</li>
        <li>
    <a class="dropdown-item" href="../intro/about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-deep-neural-networks" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Deep Neural Networks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-deep-neural-networks">    
        <li class="dropdown-header">DeepLearning</li>
        <li>
    <a class="dropdown-item" href="../DeepLearning/c1w1.html">
 <span class="dropdown-text">Introduction to TensorFlow W1:A New Programming Paradigm</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../DeepLearning/c1w2.html">
 <span class="dropdown-text">Introduction to TensorFlow W2:Introduction to Computer Vision</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../DeepLearning/c1w3.html">
 <span class="dropdown-text">Introduction to TensorFlow W3:Enhancing Vision with Convolutional Neural Networks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../DeepLearning/c1w4.html">
 <span class="dropdown-text">Introduction to TensorFlow W4:Using Real-world Images</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-convolutional-neural-networks" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Convolutional Neural Networks</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-convolutional-neural-networks">    
        <li class="dropdown-header">Convolutional Neural Networks in TensorFlow</li>
        <li>
    <a class="dropdown-item" href="../Convolutional Neural Networks in TensorFlow/c2week1.html">
 <span class="dropdown-text">W1:Exploring a Larger Dataset</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Convolutional Neural Networks in TensorFlow/c2week2.html">
 <span class="dropdown-text">W2:Augmentation: A technique to avoid overfitting</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Convolutional Neural Networks in TensorFlow/c2week3.html">
 <span class="dropdown-text">W3:Transfer learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Convolutional Neural Networks in TensorFlow/c2week4.html">
 <span class="dropdown-text">W4:multi-class classification</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-natural-language-processing" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Natural Language Processing</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-natural-language-processing">    
        <li class="dropdown-header">Natural Language Processing</li>
        <li>
    <a class="dropdown-item" href="../Natural Language Processing/c3week1.html">
 <span class="dropdown-text">W1:Sentiment in text</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Natural Language Processing/c3week2.html">
 <span class="dropdown-text">W2:Word Embeddings</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Natural Language Processing/c3week3.html">
 <span class="dropdown-text">W3:Sequence models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Natural Language Processing/c3week4.html">
 <span class="dropdown-text">W4:Sequence models and literature</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-time-series" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Time Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-time-series">    
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tensorflow-tree-model" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">tensorflow tree model</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tensorflow-tree-model">    
        <li class="dropdown-header">tree model</li>
        <li>
    <a class="dropdown-item" href="../tree model/1 install package.html">
 <span class="dropdown-text">install pacakge</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tree model/2 Keras random forests regression model.html">
 <span class="dropdown-text">Keras random forests regression model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tree model/3 Keras tuned random forests regression model.html">
 <span class="dropdown-text">Keras tuned random forests regression model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tree model/4 Keras GBT regression model.html">
 <span class="dropdown-text">Keras Gradient BoostedTrees Model regression model</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../tree model/5 Keras tuned GBT regression model.html">
 <span class="dropdown-text">Keras tuned Gradient BoostedTrees Model regression model</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Convolutional Neural Networks in TensorFlow/c2week1.html">Convolutional Neural Networks in TensorFlow</a></li><li class="breadcrumb-item"><a href="../Convolutional Neural Networks in TensorFlow/c2week1.html">W1:Exploring a Larger Dataset</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Convolutional Neural Networks in TensorFlow</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Convolutional Neural Networks in TensorFlow/c2week1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">W1:Exploring a Larger Dataset</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Convolutional Neural Networks in TensorFlow/c2week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">W2:Augmentation: A technique to avoid overfitting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Convolutional Neural Networks in TensorFlow/c2week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">W3:Transfer learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Convolutional Neural Networks in TensorFlow/c2week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">W4:multi-class classification</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#download-data" id="toc-download-data" class="nav-link active" data-scroll-target="#download-data"><span class="header-section-number">1</span> download data</a>
  <ul class="collapse">
  <li><a href="#download-small-cats_and_dogs_filtered.zip-which-have-train-and-validation-folder" id="toc-download-small-cats_and_dogs_filtered.zip-which-have-train-and-validation-folder" class="nav-link" data-scroll-target="#download-small-cats_and_dogs_filtered.zip-which-have-train-and-validation-folder"><span class="header-section-number">1.1</span> download small cats_and_dogs_filtered.zip which have train and validation folder</a></li>
  </ul></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data"><span class="header-section-number">2</span> Load the data</a></li>
  <li><a href="#define-convolutional-model" id="toc-define-convolutional-model" class="nav-link" data-scroll-target="#define-convolutional-model"><span class="header-section-number">3</span> define convolutional model</a></li>
  <li><a href="#compile-model" id="toc-compile-model" class="nav-link" data-scroll-target="#compile-model"><span class="header-section-number">4</span> compile model</a></li>
  <li><a href="#callbacks" id="toc-callbacks" class="nav-link" data-scroll-target="#callbacks"><span class="header-section-number">5</span> Callbacks</a></li>
  <li><a href="#train-model" id="toc-train-model" class="nav-link" data-scroll-target="#train-model"><span class="header-section-number">6</span> train model</a></li>
  <li><a href="#training-result" id="toc-training-result" class="nav-link" data-scroll-target="#training-result"><span class="header-section-number">7</span> training result</a></li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">8</span> Prediction</a></li>
  <li><a href="#resource" id="toc-resource" class="nav-link" data-scroll-target="#resource"><span class="header-section-number">9</span> resource:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Convolutional Neural Networks in TensorFlow/c2week1.html">Convolutional Neural Networks in TensorFlow</a></li><li class="breadcrumb-item"><a href="../Convolutional Neural Networks in TensorFlow/c2week1.html">W1:Exploring a Larger Dataset</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">W1:Exploring a Larger Dataset</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="download-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> download data</h1>
<section id="download-small-cats_and_dogs_filtered.zip-which-have-train-and-validation-folder" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="download-small-cats_and_dogs_filtered.zip-which-have-train-and-validation-folder"><span class="header-section-number">1.1</span> download small cats_and_dogs_filtered.zip which have train and validation folder</h2>
<div id="9e9e8fa5" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">"https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip"</span>, <span class="st">"cats_and_dogs_filtered.zip"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="6f4d1ffe" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the archive</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>local_zip <span class="op">=</span> <span class="st">'./cats_and_dogs_filtered.zip'</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>zip_ref <span class="op">=</span> zipfile.ZipFile(local_zip, <span class="st">'r'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>zip_ref.extractall()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>zip_ref.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b2a7f2e3" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'./tmp/cats_and_dogs_filtered/train/cats/cat.0.jpg'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>im.size <span class="co"># (width,height) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(500, 374)</code></pre>
</div>
</div>
<div id="6abefb4d" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>base_dir <span class="op">=</span> <span class="st">'./tmp/cats_and_dogs_filtered'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Contents of base directory:"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(base_dir))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Contents of train directory:"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(<span class="ss">f'</span><span class="sc">{</span>base_dir<span class="sc">}</span><span class="ss">/train'</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Contents of validation directory:"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(<span class="ss">f'</span><span class="sc">{</span>base_dir<span class="sc">}</span><span class="ss">/validation'</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> os.path.join(base_dir, <span class="st">'train'</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>validation_dir <span class="op">=</span> os.path.join(base_dir, <span class="st">'validation'</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory with training cat/dog pictures</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>train_cats_dir <span class="op">=</span> os.path.join(train_dir, <span class="st">'cats'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>train_dogs_dir <span class="op">=</span> os.path.join(train_dir, <span class="st">'dogs'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory with validation cat/dog pictures</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>validation_cats_dir <span class="op">=</span> os.path.join(validation_dir, <span class="st">'cats'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>validation_dogs_dir <span class="op">=</span> os.path.join(validation_dir, <span class="st">'dogs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Contents of base directory:
['.DS_Store', 'train', 'validation']

Contents of train directory:
['dogs', 'cats', '.DS_Store']

Contents of validation directory:
['dogs', 'cats', '.DS_Store']</code></pre>
</div>
</div>
<div id="26cec864" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_cat_fnames <span class="op">=</span> os.listdir( train_cats_dir )</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_dog_fnames <span class="op">=</span> os.listdir( train_dogs_dir )</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_cat_fnames[:<span class="dv">10</span>])</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_dog_fnames[:<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['cat.952.jpg', 'cat.946.jpg', 'cat.6.jpg', 'cat.749.jpg', 'cat.991.jpg', 'cat.985.jpg', 'cat.775.jpg', 'cat.761.jpg', 'cat.588.jpg', 'cat.239.jpg']
['dog.775.jpg', 'dog.761.jpg', 'dog.991.jpg', 'dog.749.jpg', 'dog.985.jpg', 'dog.952.jpg', 'dog.946.jpg', 'dog.211.jpg', 'dog.577.jpg', 'dog.563.jpg']</code></pre>
</div>
</div>
<div id="30c8dcc3" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total training cat images :'</span>, <span class="bu">len</span>(os.listdir(      train_cats_dir ) ))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total training dog images :'</span>, <span class="bu">len</span>(os.listdir(      train_dogs_dir ) ))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total validation cat images :'</span>, <span class="bu">len</span>(os.listdir( validation_cats_dir ) ))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total validation dog images :'</span>, <span class="bu">len</span>(os.listdir( validation_dogs_dir ) ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>total training cat images : 1000
total training dog images : 1000
total validation cat images : 500
total validation dog images : 500</code></pre>
</div>
</div>
<div id="ed59f4a7" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for our graph; we'll output images in a 4x4 configuration</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>pic_index <span class="op">=</span> <span class="dv">0</span> <span class="co"># Index for iterating over images</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up matplotlib fig, and size it to fit 4x4 pics</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.gcf()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(ncols<span class="op">*</span><span class="dv">4</span>, nrows<span class="op">*</span><span class="dv">4</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>pic_index<span class="op">+=</span><span class="dv">8</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>next_cat_pix <span class="op">=</span> [os.path.join(train_cats_dir, fname) </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_cat_fnames[ pic_index<span class="op">-</span><span class="dv">8</span>:pic_index] </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>next_dog_pix <span class="op">=</span> [os.path.join(train_dogs_dir, fname) </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_dog_fnames[ pic_index<span class="op">-</span><span class="dv">8</span>:pic_index]</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, img_path <span class="kw">in</span> <span class="bu">enumerate</span>(next_cat_pix<span class="op">+</span>next_dog_pix):</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up subplot; subplot indices start at 1</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  sp <span class="op">=</span> plt.subplot(nrows, ncols, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  sp.axis(<span class="st">'Off'</span>) <span class="co"># Don't show axes (or gridlines)</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  img <span class="op">=</span> mpimg.imread(img_path)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  plt.imshow(img)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="c2week1_files/figure-html/cell-8-output-1.png" width="1210" height="1171" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="5698ba35" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tf.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>2.16.1</code></pre>
</div>
</div>
</section>
</section>
<section id="load-the-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Load the data</h1>
<p>ImageDataGenerator: All images will be resized to 150x150</p>
<div id="5c47cab0" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># All images will be rescaled by 1./255.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>train_datagen <span class="op">=</span> ImageDataGenerator( rescale <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span><span class="fl">255.</span> )</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>test_datagen  <span class="op">=</span> ImageDataGenerator( rescale <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span><span class="fl">255.</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Image Data from directory</p>
<div id="7f8b1530" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Flow training images in batches of 20 using train_datagen generator</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>train_generator <span class="op">=</span> train_datagen.flow_from_directory(train_dir,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                                    batch_size<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                                                    class_mode<span class="op">=</span><span class="st">'binary'</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                                                    target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))     </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Flow validation images in batches of 20 using test_datagen generator</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>validation_generator <span class="op">=</span>  test_datagen.flow_from_directory(validation_dir,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                                         batch_size<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                                         class_mode  <span class="op">=</span> <span class="st">'binary'</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                                                         target_size <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Found 2000 images belonging to 2 classes.
Found 1000 images belonging to 2 classes.</code></pre>
</div>
</div>
</section>
<section id="define-convolutional-model" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> define convolutional model</h1>
<p>input 150 by 150 color image</p>
<p>flow into 16 3by3 convolutional layers and 2by2 pooling</p>
<p>output is 1 neural(0/1) sigmoid function.its good for binary</p>
<div id="6aa1526a" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note the input shape is the desired size of the image 150x150 with 3 bytes color</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">16</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flatten the results to feed into a DNN</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Flatten(), </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 512 neuron hidden layer</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class ('cats') and 1 for the other ('dogs')</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)  </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="be3b47e2" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv2d (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">148</span>, <span style="color: #00af00; text-decoration-color: #00af00">148</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)   │           <span style="color: #00af00; text-decoration-color: #00af00">448</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)    │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">74</span>, <span style="color: #00af00; text-decoration-color: #00af00">74</span>, <span style="color: #00af00; text-decoration-color: #00af00">16</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">72</span>, <span style="color: #00af00; text-decoration-color: #00af00">72</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │         <span style="color: #00af00; text-decoration-color: #00af00">4,640</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">36</span>, <span style="color: #00af00; text-decoration-color: #00af00">36</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">34</span>, <span style="color: #00af00; text-decoration-color: #00af00">34</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)     │        <span style="color: #00af00; text-decoration-color: #00af00">18,496</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">MaxPooling2D</span>)  │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">17</span>, <span style="color: #00af00; text-decoration-color: #00af00">17</span>, <span style="color: #00af00; text-decoration-color: #00af00">64</span>)     │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ flatten (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">18496</span>)          │             <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">512</span>)            │     <span style="color: #00af00; text-decoration-color: #00af00">9,470,464</span> │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)              │           <span style="color: #00af00; text-decoration-color: #00af00">513</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">9,494,561</span> (36.22 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">9,494,561</span> (36.22 MB)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
</section>
<section id="compile-model" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> compile model</h1>
<div id="d38cef00" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># v2.11+ optimizer `tf.keras.optimizers.RMSprop` runs slowly on M1/M2 Macs</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> RMSprop</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>              optimizer<span class="op">=</span>RMSprop(learning_rate<span class="op">=</span><span class="fl">0.001</span>),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>              metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="callbacks" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Callbacks</h1>
<div id="2d5c2602" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> myCallback(tf.keras.callbacks.Callback):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> on_epoch_end(<span class="va">self</span>, epoch, logs<span class="op">=</span>{}):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Halts the training when the loss falls below 0.15</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">      epoch (integer) - index of epoch (required but unused in the function definition below)</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">      logs (dict) - metric results from the training epoch</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check the loss</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(logs.get(<span class="st">'loss'</span>) <span class="op">&lt;</span> <span class="fl">0.15</span>):</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Stop if threshold is met</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Loss is lower than 0.2 so cancelling training!"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"cancelling training with:"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(epoch<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.model.stop_training <span class="op">=</span> <span class="va">True</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate class</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> myCallback()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="train-model" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> train model</h1>
<div id="35327930" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>            train_generator,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>            epochs<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            validation_data<span class="op">=</span>validation_generator,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            callbacks<span class="op">=</span>[callbacks]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 59s 598ms/step - accuracy: 0.3000 - loss: 0.7178  2/100 ━━━━━━━━━━━━━━━━━━━━ 8s 84ms/step - accuracy: 0.3250 - loss: 2.3252    3/100 ━━━━━━━━━━━━━━━━━━━━ 7s 81ms/step - accuracy: 0.3611 - loss: 2.4945  4/100 ━━━━━━━━━━━━━━━━━━━━ 7s 79ms/step - accuracy: 0.3865 - loss: 2.4462  5/100 ━━━━━━━━━━━━━━━━━━━━ 7s 79ms/step - accuracy: 0.4032 - loss: 2.3534  6/100 ━━━━━━━━━━━━━━━━━━━━ 7s 79ms/step - accuracy: 0.4179 - loss: 2.2552  7/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.4317 - loss: 2.1624  8/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.4433 - loss: 2.0780  9/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.4515 - loss: 2.0026 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.4578 - loss: 1.9353 11/100 ━━━━━━━━━━━━━━━━━━━━ 7s 81ms/step - accuracy: 0.4629 - loss: 1.8749 12/100 ━━━━━━━━━━━━━━━━━━━━ 7s 83ms/step - accuracy: 0.4660 - loss: 1.8216 13/100 ━━━━━━━━━━━━━━━━━━━━ 7s 82ms/step - accuracy: 0.4671 - loss: 1.7736 14/100 ━━━━━━━━━━━━━━━━━━━━ 7s 81ms/step - accuracy: 0.4680 - loss: 1.7298 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 81ms/step - accuracy: 0.4692 - loss: 1.6897 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 81ms/step - accuracy: 0.4702 - loss: 1.6530 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 80ms/step - accuracy: 0.4709 - loss: 1.6192 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 80ms/step - accuracy: 0.4713 - loss: 1.5879 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 80ms/step - accuracy: 0.4719 - loss: 1.5589 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.4728 - loss: 1.5319 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.4736 - loss: 1.5067 22/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.4743 - loss: 1.4832 23/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.4751 - loss: 1.4611 24/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.4760 - loss: 1.4404 25/100 ━━━━━━━━━━━━━━━━━━━━ 5s 79ms/step - accuracy: 0.4768 - loss: 1.4209 26/100 ━━━━━━━━━━━━━━━━━━━━ 5s 79ms/step - accuracy: 0.4780 - loss: 1.4025 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 79ms/step - accuracy: 0.4795 - loss: 1.3851 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4811 - loss: 1.3686 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4828 - loss: 1.3530 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4844 - loss: 1.3382 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4858 - loss: 1.3242 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4871 - loss: 1.3108 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4885 - loss: 1.2980 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4899 - loss: 1.2858 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.4911 - loss: 1.2742 36/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4922 - loss: 1.2631 37/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4932 - loss: 1.2524 38/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4942 - loss: 1.2422 39/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4951 - loss: 1.2324 40/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4961 - loss: 1.2230 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4970 - loss: 1.2140 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4981 - loss: 1.2052 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.4990 - loss: 1.1968 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.4999 - loss: 1.1887 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.5006 - loss: 1.1809 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5014 - loss: 1.1734 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5020 - loss: 1.1661 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5026 - loss: 1.1591 49/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5032 - loss: 1.1523 50/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5038 - loss: 1.1457 51/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5043 - loss: 1.1393 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5048 - loss: 1.1331 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5054 - loss: 1.1271 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5060 - loss: 1.1213 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5066 - loss: 1.1157 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5071 - loss: 1.1102 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5075 - loss: 1.1049 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5080 - loss: 1.0997 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5085 - loss: 1.0946 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5090 - loss: 1.0897 61/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5094 - loss: 1.0849 62/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5098 - loss: 1.0803 63/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5103 - loss: 1.0758 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5106 - loss: 1.0714 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5110 - loss: 1.0671 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5113 - loss: 1.0629 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5116 - loss: 1.0588 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5118 - loss: 1.0549 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5121 - loss: 1.0510 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5123 - loss: 1.0472 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5126 - loss: 1.0435 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5128 - loss: 1.0399 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.5130 - loss: 1.0363 74/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5132 - loss: 1.0329 75/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5134 - loss: 1.0295 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5135 - loss: 1.0262 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5137 - loss: 1.0229 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5139 - loss: 1.0198 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5141 - loss: 1.0166 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5142 - loss: 1.0136 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5144 - loss: 1.0106 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5146 - loss: 1.0077 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5148 - loss: 1.0048 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5151 - loss: 1.0021 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5153 - loss: 0.9993 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 76ms/step - accuracy: 0.5155 - loss: 0.9966 87/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5157 - loss: 0.9940 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5159 - loss: 0.9914 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5161 - loss: 0.9889 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5163 - loss: 0.9864 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5166 - loss: 0.9840 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5168 - loss: 0.9816 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5170 - loss: 0.9792 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5173 - loss: 0.9769 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5175 - loss: 0.9746 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5177 - loss: 0.9724 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5179 - loss: 0.9702 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5181 - loss: 0.9681 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5183 - loss: 0.9659100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 76ms/step - accuracy: 0.5185 - loss: 0.9639100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 90ms/step - accuracy: 0.5187 - loss: 0.9618 - val_accuracy: 0.5620 - val_loss: 0.6752
Epoch 2/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 23s 233ms/step - accuracy: 0.5000 - loss: 0.6845  2/100 ━━━━━━━━━━━━━━━━━━━━ 7s 76ms/step - accuracy: 0.5375 - loss: 0.6816    3/100 ━━━━━━━━━━━━━━━━━━━━ 7s 75ms/step - accuracy: 0.5361 - loss: 0.6814  4/100 ━━━━━━━━━━━━━━━━━━━━ 7s 75ms/step - accuracy: 0.5365 - loss: 0.6801  5/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.5352 - loss: 0.6792  6/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.5362 - loss: 0.6782  7/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.5403 - loss: 0.6769  8/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.5430 - loss: 0.6755  9/100 ━━━━━━━━━━━━━━━━━━━━ 7s 77ms/step - accuracy: 0.5463 - loss: 0.6742 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5492 - loss: 0.6728 11/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5534 - loss: 0.6707 12/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5569 - loss: 0.6752 13/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5596 - loss: 0.6788 14/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5617 - loss: 0.6817 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5645 - loss: 0.6836 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.5663 - loss: 0.6852 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5680 - loss: 0.6865 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5688 - loss: 0.6878 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5695 - loss: 0.6887 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5698 - loss: 0.6896 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5706 - loss: 0.6902 22/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.5715 - loss: 0.6906 23/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5727 - loss: 0.6908 24/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5739 - loss: 0.6909 25/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5747 - loss: 0.6910 26/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5754 - loss: 0.6911 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5760 - loss: 0.6910 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5766 - loss: 0.6910 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5771 - loss: 0.6909 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5777 - loss: 0.6907 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5781 - loss: 0.6905 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5788 - loss: 0.6903 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5794 - loss: 0.6900 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5801 - loss: 0.6897 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.5807 - loss: 0.6894 36/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5813 - loss: 0.6890 37/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5815 - loss: 0.6888 38/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5819 - loss: 0.6885 39/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5821 - loss: 0.6885 40/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5822 - loss: 0.6885 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5822 - loss: 0.6885 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5822 - loss: 0.6885 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5823 - loss: 0.6884 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5822 - loss: 0.6884 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5824 - loss: 0.6883 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5826 - loss: 0.6882 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5828 - loss: 0.6880 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.5830 - loss: 0.6879 49/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5832 - loss: 0.6877 50/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5835 - loss: 0.6876 51/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5837 - loss: 0.6875 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5839 - loss: 0.6874 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5840 - loss: 0.6874 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5842 - loss: 0.6873 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5845 - loss: 0.6872 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5847 - loss: 0.6871 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5850 - loss: 0.6870 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5852 - loss: 0.6870 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5855 - loss: 0.6869 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5857 - loss: 0.6868 61/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.5860 - loss: 0.6867 62/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5863 - loss: 0.6866 63/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5866 - loss: 0.6864 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5869 - loss: 0.6863 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5872 - loss: 0.6862 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5875 - loss: 0.6860 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5878 - loss: 0.6859 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5880 - loss: 0.6858 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5882 - loss: 0.6856 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5884 - loss: 0.6855 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5886 - loss: 0.6854 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5888 - loss: 0.6853 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5891 - loss: 0.6851 74/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.5894 - loss: 0.6850 75/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5897 - loss: 0.6848 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5900 - loss: 0.6846 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5903 - loss: 0.6845 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5905 - loss: 0.6843 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5908 - loss: 0.6842 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 79ms/step - accuracy: 0.5911 - loss: 0.6841 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 79ms/step - accuracy: 0.5913 - loss: 0.6839 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 79ms/step - accuracy: 0.5915 - loss: 0.6838 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5918 - loss: 0.6836 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5920 - loss: 0.6835 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5923 - loss: 0.6833 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5926 - loss: 0.6832 87/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.5928 - loss: 0.6830 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5931 - loss: 0.6829 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5934 - loss: 0.6827 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5936 - loss: 0.6825 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5939 - loss: 0.6824 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5941 - loss: 0.6822 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5944 - loss: 0.6820 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5946 - loss: 0.6819 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5948 - loss: 0.6817 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.5950 - loss: 0.6816 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.5953 - loss: 0.6814 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.5955 - loss: 0.6813 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.5957 - loss: 0.6812100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 77ms/step - accuracy: 0.5959 - loss: 0.6810100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 90ms/step - accuracy: 0.5961 - loss: 0.6809 - val_accuracy: 0.6670 - val_loss: 0.6200
Epoch 3/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 23s 234ms/step - accuracy: 0.7500 - loss: 0.5546  2/100 ━━━━━━━━━━━━━━━━━━━━ 7s 72ms/step - accuracy: 0.7375 - loss: 0.5848    3/100 ━━━━━━━━━━━━━━━━━━━━ 7s 73ms/step - accuracy: 0.7194 - loss: 0.5963  4/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7115 - loss: 0.5934  5/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.7032 - loss: 0.5924  6/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.6915 - loss: 0.5977  7/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.6846 - loss: 0.5997  8/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6803 - loss: 0.6007  9/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6769 - loss: 0.6011 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6762 - loss: 0.6005 11/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6771 - loss: 0.5991 12/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6769 - loss: 0.5988 13/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.6769 - loss: 0.5990 14/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.6768 - loss: 0.5990 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 74ms/step - accuracy: 0.6768 - loss: 0.5986 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.6765 - loss: 0.5982 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.6767 - loss: 0.5976 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.6764 - loss: 0.5980 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.6761 - loss: 0.5984 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.6762 - loss: 0.5984 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.6759 - loss: 0.5990 22/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6755 - loss: 0.5995 23/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6751 - loss: 0.6000 24/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6748 - loss: 0.6004 25/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6749 - loss: 0.6007 26/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6749 - loss: 0.6011 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6749 - loss: 0.6014 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.6752 - loss: 0.6015 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6754 - loss: 0.6019 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6755 - loss: 0.6022 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6759 - loss: 0.6024 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6763 - loss: 0.6024 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6767 - loss: 0.6025 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 77ms/step - accuracy: 0.6771 - loss: 0.6024 35/100 ━━━━━━━━━━━━━━━━━━━━ 4s 77ms/step - accuracy: 0.6774 - loss: 0.6025 36/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6777 - loss: 0.6025 37/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6779 - loss: 0.6026 38/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6782 - loss: 0.6025 39/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6785 - loss: 0.6025 40/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6788 - loss: 0.6024 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6791 - loss: 0.6022 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6794 - loss: 0.6022 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6795 - loss: 0.6022 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6797 - loss: 0.6021 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6799 - loss: 0.6021 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6800 - loss: 0.6020 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.6802 - loss: 0.6019 48/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6803 - loss: 0.6018 49/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6804 - loss: 0.6016 50/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6807 - loss: 0.6014 51/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6809 - loss: 0.6012 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6810 - loss: 0.6011 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6812 - loss: 0.6010 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6814 - loss: 0.6009 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6816 - loss: 0.6008 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6817 - loss: 0.6006 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6820 - loss: 0.6005 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6822 - loss: 0.6002 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6824 - loss: 0.6000 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.6826 - loss: 0.5998 61/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6828 - loss: 0.5996 62/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6830 - loss: 0.5994 63/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6832 - loss: 0.5993 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6833 - loss: 0.5992 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6835 - loss: 0.5990 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6837 - loss: 0.5989 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6839 - loss: 0.5987 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6841 - loss: 0.5986 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6842 - loss: 0.5985 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 76ms/step - accuracy: 0.6844 - loss: 0.5983 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.6846 - loss: 0.5982 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.6847 - loss: 0.5981 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.6848 - loss: 0.5979 74/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6849 - loss: 0.5978 75/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6850 - loss: 0.5977 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6852 - loss: 0.5976 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6853 - loss: 0.5975 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6854 - loss: 0.5973 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6856 - loss: 0.5972 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6857 - loss: 0.5971 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6858 - loss: 0.5970 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6859 - loss: 0.5968 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6860 - loss: 0.5967 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6862 - loss: 0.5966 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6863 - loss: 0.5965 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.6864 - loss: 0.5963 87/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6865 - loss: 0.5962 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6867 - loss: 0.5961 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6868 - loss: 0.5959 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6870 - loss: 0.5958 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6871 - loss: 0.5957 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6872 - loss: 0.5956 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6873 - loss: 0.5955 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6874 - loss: 0.5953 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6875 - loss: 0.5952 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6876 - loss: 0.5951 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6877 - loss: 0.5951 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6877 - loss: 0.5950 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6878 - loss: 0.5949100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.6879 - loss: 0.5949100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 90ms/step - accuracy: 0.6880 - loss: 0.5948 - val_accuracy: 0.5820 - val_loss: 0.6890
Epoch 4/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 23s 239ms/step - accuracy: 0.6500 - loss: 0.6006  2/100 ━━━━━━━━━━━━━━━━━━━━ 6s 71ms/step - accuracy: 0.6875 - loss: 0.5686    3/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7083 - loss: 0.5570  4/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7031 - loss: 0.5666  5/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.7065 - loss: 0.5660  6/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7096 - loss: 0.5652  7/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7092 - loss: 0.5660  8/100 ━━━━━━━━━━━━━━━━━━━━ 6s 72ms/step - accuracy: 0.7112 - loss: 0.5640  9/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.7137 - loss: 0.5613 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 73ms/step - accuracy: 0.7153 - loss: 0.5587 11/100 ━━━━━━━━━━━━━━━━━━━━ 6s 74ms/step - accuracy: 0.7176 - loss: 0.5558 12/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.7203 - loss: 0.5526 13/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.7232 - loss: 0.5500 14/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.7254 - loss: 0.5475 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.7268 - loss: 0.5459 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7275 - loss: 0.5448 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7281 - loss: 0.5436 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7285 - loss: 0.5425 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7290 - loss: 0.5415 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7294 - loss: 0.5407 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.7298 - loss: 0.5398 22/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7304 - loss: 0.5389 23/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7308 - loss: 0.5381 24/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7313 - loss: 0.5373 25/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7318 - loss: 0.5362 26/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7326 - loss: 0.5350 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7333 - loss: 0.5337 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 75ms/step - accuracy: 0.7339 - loss: 0.5328 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 76ms/step - accuracy: 0.7343 - loss: 0.5320 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 75ms/step - accuracy: 0.7348 - loss: 0.5312 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 75ms/step - accuracy: 0.7352 - loss: 0.5305 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 75ms/step - accuracy: 0.7355 - loss: 0.5299 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 75ms/step - accuracy: 0.7356 - loss: 0.5295 34/100 ━━━━━━━━━━━━━━━━━━━━ 4s 75ms/step - accuracy: 0.7358 - loss: 0.5290 35/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7360 - loss: 0.5286 36/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7361 - loss: 0.5282 37/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7362 - loss: 0.5278 38/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7363 - loss: 0.5275 39/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7362 - loss: 0.5273 40/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7363 - loss: 0.5270 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7364 - loss: 0.5267 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7365 - loss: 0.5265 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7365 - loss: 0.5262 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7365 - loss: 0.5260 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7364 - loss: 0.5258 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7363 - loss: 0.5257 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 76ms/step - accuracy: 0.7362 - loss: 0.5256 48/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7361 - loss: 0.5255 49/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7359 - loss: 0.5255 50/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7358 - loss: 0.5255 51/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7356 - loss: 0.5255 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7354 - loss: 0.5255 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7353 - loss: 0.5255 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7352 - loss: 0.5256 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7350 - loss: 0.5256 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7349 - loss: 0.5256 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7349 - loss: 0.5256 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7348 - loss: 0.5256 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 76ms/step - accuracy: 0.7347 - loss: 0.5256 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 75ms/step - accuracy: 0.7347 - loss: 0.5255 61/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7347 - loss: 0.5255 62/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7347 - loss: 0.5255 63/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7346 - loss: 0.5256 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7346 - loss: 0.5256 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7346 - loss: 0.5256 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7347 - loss: 0.5256 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7348 - loss: 0.5255 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7348 - loss: 0.5254 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7349 - loss: 0.5254 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7351 - loss: 0.5253 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7352 - loss: 0.5251 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7354 - loss: 0.5250 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 75ms/step - accuracy: 0.7355 - loss: 0.5249 74/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7357 - loss: 0.5248 75/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7358 - loss: 0.5247 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7358 - loss: 0.5247 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7359 - loss: 0.5247 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7360 - loss: 0.5247 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7360 - loss: 0.5247 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7360 - loss: 0.5247 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7361 - loss: 0.5247 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7361 - loss: 0.5247 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7362 - loss: 0.5248 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7362 - loss: 0.5248 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7362 - loss: 0.5248 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 75ms/step - accuracy: 0.7362 - loss: 0.5248 87/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5249 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5249 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7363 - loss: 0.5249 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5250 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5250 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5251 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5251 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5252 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5252 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5252 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5252 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5253 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5253100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 75ms/step - accuracy: 0.7362 - loss: 0.5253100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 89ms/step - accuracy: 0.7362 - loss: 0.5254 - val_accuracy: 0.6980 - val_loss: 0.5663
Epoch 5/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 25s 261ms/step - accuracy: 0.8500 - loss: 0.3976  2/100 ━━━━━━━━━━━━━━━━━━━━ 7s 75ms/step - accuracy: 0.8250 - loss: 0.4335    3/100 ━━━━━━━━━━━━━━━━━━━━ 7s 76ms/step - accuracy: 0.8167 - loss: 0.4482  4/100 ━━━━━━━━━━━━━━━━━━━━ 7s 76ms/step - accuracy: 0.8125 - loss: 0.4490  5/100 ━━━━━━━━━━━━━━━━━━━━ 7s 76ms/step - accuracy: 0.8060 - loss: 0.4496  6/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.8050 - loss: 0.4475  7/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.8043 - loss: 0.4463  8/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.8038 - loss: 0.4455  9/100 ━━━━━━━━━━━━━━━━━━━━ 7s 78ms/step - accuracy: 0.8046 - loss: 0.4447 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.8051 - loss: 0.4443 11/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.8055 - loss: 0.4441 12/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.8050 - loss: 0.4450 13/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.8049 - loss: 0.4453 14/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8053 - loss: 0.4456 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8057 - loss: 0.4458 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8063 - loss: 0.4455 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8068 - loss: 0.4453 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8070 - loss: 0.4454 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8069 - loss: 0.4460 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8066 - loss: 0.4467 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8067 - loss: 0.4470 22/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8070 - loss: 0.4471 23/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.8073 - loss: 0.4470 24/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8072 - loss: 0.4471 25/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8071 - loss: 0.4472 26/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8066 - loss: 0.4480 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8063 - loss: 0.4485 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8061 - loss: 0.4489 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8059 - loss: 0.4492 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8057 - loss: 0.4495 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8055 - loss: 0.4497 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8055 - loss: 0.4499 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8054 - loss: 0.4500 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8055 - loss: 0.4500 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 78ms/step - accuracy: 0.8056 - loss: 0.4498 36/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8057 - loss: 0.4496 37/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8057 - loss: 0.4495 38/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8055 - loss: 0.4496 39/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8054 - loss: 0.4496 40/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8052 - loss: 0.4496 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8052 - loss: 0.4495 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8051 - loss: 0.4495 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8050 - loss: 0.4495 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8049 - loss: 0.4495 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8048 - loss: 0.4495 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8048 - loss: 0.4494 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8047 - loss: 0.4493 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 78ms/step - accuracy: 0.8046 - loss: 0.4494 49/100 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.8044 - loss: 0.4495 50/100 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.8043 - loss: 0.4495 51/100 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.8042 - loss: 0.4495 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.8041 - loss: 0.4495 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 78ms/step - accuracy: 0.8040 - loss: 0.4495 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8039 - loss: 0.4495 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8039 - loss: 0.4494 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8037 - loss: 0.4494 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8036 - loss: 0.4494 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8034 - loss: 0.4494 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8032 - loss: 0.4494 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8031 - loss: 0.4494 61/100 ━━━━━━━━━━━━━━━━━━━━ 3s 77ms/step - accuracy: 0.8030 - loss: 0.4494 62/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8028 - loss: 0.4494 63/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8027 - loss: 0.4493 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8025 - loss: 0.4494 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8023 - loss: 0.4494 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8021 - loss: 0.4495 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 77ms/step - accuracy: 0.8019 - loss: 0.4496 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8017 - loss: 0.4497 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8015 - loss: 0.4498 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8013 - loss: 0.4499 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8011 - loss: 0.4500 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8008 - loss: 0.4502 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8006 - loss: 0.4503 74/100 ━━━━━━━━━━━━━━━━━━━━ 2s 78ms/step - accuracy: 0.8005 - loss: 0.4504 75/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.8003 - loss: 0.4505 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.8001 - loss: 0.4507 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7999 - loss: 0.4508 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7997 - loss: 0.4509 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7996 - loss: 0.4510 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7994 - loss: 0.4511 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7993 - loss: 0.4512 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7991 - loss: 0.4512 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7990 - loss: 0.4513 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7988 - loss: 0.4514 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7986 - loss: 0.4515 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7984 - loss: 0.4516 87/100 ━━━━━━━━━━━━━━━━━━━━ 1s 78ms/step - accuracy: 0.7983 - loss: 0.4517 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7982 - loss: 0.4517 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7980 - loss: 0.4518 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7979 - loss: 0.4519 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7977 - loss: 0.4519 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7975 - loss: 0.4520 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7974 - loss: 0.4521 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7972 - loss: 0.4522 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7970 - loss: 0.4523 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7969 - loss: 0.4524 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7967 - loss: 0.4525 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7966 - loss: 0.4526 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7964 - loss: 0.4527100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 78ms/step - accuracy: 0.7963 - loss: 0.4527100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 93ms/step - accuracy: 0.7962 - loss: 0.4528 - val_accuracy: 0.7400 - val_loss: 0.5272
Epoch 6/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 27s 281ms/step - accuracy: 0.9500 - loss: 0.2997  2/100 ━━━━━━━━━━━━━━━━━━━━ 10s 112ms/step - accuracy: 0.9375 - loss: 0.2888  3/100 ━━━━━━━━━━━━━━━━━━━━ 9s 100ms/step - accuracy: 0.9028 - loss: 0.3131   4/100 ━━━━━━━━━━━━━━━━━━━━ 10s 105ms/step - accuracy: 0.8865 - loss: 0.3254  5/100 ━━━━━━━━━━━━━━━━━━━━ 10s 107ms/step - accuracy: 0.8772 - loss: 0.3368  6/100 ━━━━━━━━━━━━━━━━━━━━ 9s 104ms/step - accuracy: 0.8685 - loss: 0.3461   7/100 ━━━━━━━━━━━━━━━━━━━━ 9s 103ms/step - accuracy: 0.8607 - loss: 0.3532  8/100 ━━━━━━━━━━━━━━━━━━━━ 9s 106ms/step - accuracy: 0.8563 - loss: 0.3565  9/100 ━━━━━━━━━━━━━━━━━━━━ 9s 105ms/step - accuracy: 0.8531 - loss: 0.3592 10/100 ━━━━━━━━━━━━━━━━━━━━ 9s 105ms/step - accuracy: 0.8498 - loss: 0.3622 11/100 ━━━━━━━━━━━━━━━━━━━━ 9s 104ms/step - accuracy: 0.8482 - loss: 0.3636 12/100 ━━━━━━━━━━━━━━━━━━━━ 9s 107ms/step - accuracy: 0.8462 - loss: 0.3661 13/100 ━━━━━━━━━━━━━━━━━━━━ 9s 105ms/step - accuracy: 0.8444 - loss: 0.3689 14/100 ━━━━━━━━━━━━━━━━━━━━ 8s 103ms/step - accuracy: 0.8428 - loss: 0.3712 15/100 ━━━━━━━━━━━━━━━━━━━━ 8s 101ms/step - accuracy: 0.8415 - loss: 0.3727 16/100 ━━━━━━━━━━━━━━━━━━━━ 8s 100ms/step - accuracy: 0.8405 - loss: 0.3735 17/100 ━━━━━━━━━━━━━━━━━━━━ 8s 99ms/step - accuracy: 0.8393 - loss: 0.3741  18/100 ━━━━━━━━━━━━━━━━━━━━ 8s 98ms/step - accuracy: 0.8379 - loss: 0.3748 19/100 ━━━━━━━━━━━━━━━━━━━━ 7s 97ms/step - accuracy: 0.8370 - loss: 0.3751 20/100 ━━━━━━━━━━━━━━━━━━━━ 7s 97ms/step - accuracy: 0.8363 - loss: 0.3752 21/100 ━━━━━━━━━━━━━━━━━━━━ 7s 96ms/step - accuracy: 0.8357 - loss: 0.3750 22/100 ━━━━━━━━━━━━━━━━━━━━ 7s 95ms/step - accuracy: 0.8354 - loss: 0.3745 23/100 ━━━━━━━━━━━━━━━━━━━━ 7s 95ms/step - accuracy: 0.8351 - loss: 0.3740 24/100 ━━━━━━━━━━━━━━━━━━━━ 7s 95ms/step - accuracy: 0.8348 - loss: 0.3735 25/100 ━━━━━━━━━━━━━━━━━━━━ 7s 95ms/step - accuracy: 0.8345 - loss: 0.3728 26/100 ━━━━━━━━━━━━━━━━━━━━ 6s 94ms/step - accuracy: 0.8342 - loss: 0.3722 27/100 ━━━━━━━━━━━━━━━━━━━━ 6s 95ms/step - accuracy: 0.8340 - loss: 0.3716 28/100 ━━━━━━━━━━━━━━━━━━━━ 6s 95ms/step - accuracy: 0.8336 - loss: 0.3712 29/100 ━━━━━━━━━━━━━━━━━━━━ 6s 94ms/step - accuracy: 0.8332 - loss: 0.3709 30/100 ━━━━━━━━━━━━━━━━━━━━ 6s 94ms/step - accuracy: 0.8328 - loss: 0.3707 31/100 ━━━━━━━━━━━━━━━━━━━━ 6s 94ms/step - accuracy: 0.8325 - loss: 0.3704 32/100 ━━━━━━━━━━━━━━━━━━━━ 6s 93ms/step - accuracy: 0.8323 - loss: 0.3701 33/100 ━━━━━━━━━━━━━━━━━━━━ 6s 93ms/step - accuracy: 0.8320 - loss: 0.3699 34/100 ━━━━━━━━━━━━━━━━━━━━ 6s 92ms/step - accuracy: 0.8319 - loss: 0.3696 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8318 - loss: 0.3692 36/100 ━━━━━━━━━━━━━━━━━━━━ 5s 91ms/step - accuracy: 0.8315 - loss: 0.3690 37/100 ━━━━━━━━━━━━━━━━━━━━ 5s 91ms/step - accuracy: 0.8312 - loss: 0.3689 38/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8309 - loss: 0.3688 39/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8307 - loss: 0.3687 40/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8304 - loss: 0.3687 41/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8302 - loss: 0.3687 42/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8299 - loss: 0.3687 43/100 ━━━━━━━━━━━━━━━━━━━━ 5s 92ms/step - accuracy: 0.8297 - loss: 0.3687 44/100 ━━━━━━━━━━━━━━━━━━━━ 5s 91ms/step - accuracy: 0.8296 - loss: 0.3686 45/100 ━━━━━━━━━━━━━━━━━━━━ 5s 91ms/step - accuracy: 0.8294 - loss: 0.3687 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 91ms/step - accuracy: 0.8293 - loss: 0.3687 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 91ms/step - accuracy: 0.8292 - loss: 0.3687 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 90ms/step - accuracy: 0.8291 - loss: 0.3687 49/100 ━━━━━━━━━━━━━━━━━━━━ 4s 90ms/step - accuracy: 0.8291 - loss: 0.3687 50/100 ━━━━━━━━━━━━━━━━━━━━ 4s 90ms/step - accuracy: 0.8290 - loss: 0.3686 51/100 ━━━━━━━━━━━━━━━━━━━━ 4s 90ms/step - accuracy: 0.8289 - loss: 0.3686 52/100 ━━━━━━━━━━━━━━━━━━━━ 4s 89ms/step - accuracy: 0.8289 - loss: 0.3685 53/100 ━━━━━━━━━━━━━━━━━━━━ 4s 89ms/step - accuracy: 0.8287 - loss: 0.3685 54/100 ━━━━━━━━━━━━━━━━━━━━ 4s 89ms/step - accuracy: 0.8287 - loss: 0.3685 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 89ms/step - accuracy: 0.8286 - loss: 0.3684 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8286 - loss: 0.3683 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8285 - loss: 0.3683 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8284 - loss: 0.3682 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8283 - loss: 0.3683 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8282 - loss: 0.3684 61/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8282 - loss: 0.3684 62/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.8281 - loss: 0.3685 63/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.8281 - loss: 0.3685 64/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.8280 - loss: 0.3685 65/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.8280 - loss: 0.3685 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.8280 - loss: 0.3685 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.8279 - loss: 0.3685 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.8279 - loss: 0.3685 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.8279 - loss: 0.3685 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8278 - loss: 0.3685 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8278 - loss: 0.3686 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8277 - loss: 0.3686 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8277 - loss: 0.3687 74/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8276 - loss: 0.3687 75/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8275 - loss: 0.3688 76/100 ━━━━━━━━━━━━━━━━━━━━ 2s 86ms/step - accuracy: 0.8275 - loss: 0.3688 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 86ms/step - accuracy: 0.8274 - loss: 0.3689 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8273 - loss: 0.3689 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8273 - loss: 0.3689 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8272 - loss: 0.3689 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8272 - loss: 0.3689 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8271 - loss: 0.3690 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8271 - loss: 0.3690 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8270 - loss: 0.3691 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8269 - loss: 0.3692 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8268 - loss: 0.3693 87/100 ━━━━━━━━━━━━━━━━━━━━ 1s 85ms/step - accuracy: 0.8268 - loss: 0.3695 88/100 ━━━━━━━━━━━━━━━━━━━━ 1s 84ms/step - accuracy: 0.8267 - loss: 0.3696 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8266 - loss: 0.3697 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8265 - loss: 0.3698 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8264 - loss: 0.3700 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8263 - loss: 0.3701 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8262 - loss: 0.3702 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8262 - loss: 0.3703 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8261 - loss: 0.3704 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8260 - loss: 0.3706 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8259 - loss: 0.3707 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8258 - loss: 0.3709 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8256 - loss: 0.3711100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 84ms/step - accuracy: 0.8256 - loss: 0.3712100/100 ━━━━━━━━━━━━━━━━━━━━ 10s 97ms/step - accuracy: 0.8255 - loss: 0.3714 - val_accuracy: 0.6810 - val_loss: 0.6508
Epoch 7/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 24s 242ms/step - accuracy: 0.8000 - loss: 0.4919  2/100 ━━━━━━━━━━━━━━━━━━━━ 7s 74ms/step - accuracy: 0.8125 - loss: 0.4448    3/100 ━━━━━━━━━━━━━━━━━━━━ 8s 88ms/step - accuracy: 0.8250 - loss: 0.4163  4/100 ━━━━━━━━━━━━━━━━━━━━ 8s 85ms/step - accuracy: 0.8375 - loss: 0.3961  5/100 ━━━━━━━━━━━━━━━━━━━━ 8s 89ms/step - accuracy: 0.8480 - loss: 0.3780  6/100 ━━━━━━━━━━━━━━━━━━━━ 8s 89ms/step - accuracy: 0.8539 - loss: 0.3680  7/100 ━━━━━━━━━━━━━━━━━━━━ 8s 90ms/step - accuracy: 0.8584 - loss: 0.3599  8/100 ━━━━━━━━━━━━━━━━━━━━ 8s 88ms/step - accuracy: 0.8628 - loss: 0.3524  9/100 ━━━━━━━━━━━━━━━━━━━━ 7s 86ms/step - accuracy: 0.8664 - loss: 0.3466 10/100 ━━━━━━━━━━━━━━━━━━━━ 7s 89ms/step - accuracy: 0.8677 - loss: 0.3432 11/100 ━━━━━━━━━━━━━━━━━━━━ 7s 90ms/step - accuracy: 0.8694 - loss: 0.3396 12/100 ━━━━━━━━━━━━━━━━━━━━ 8s 92ms/step - accuracy: 0.8706 - loss: 0.3363 13/100 ━━━━━━━━━━━━━━━━━━━━ 7s 91ms/step - accuracy: 0.8720 - loss: 0.3330 14/100 ━━━━━━━━━━━━━━━━━━━━ 7s 90ms/step - accuracy: 0.8734 - loss: 0.3293 15/100 ━━━━━━━━━━━━━━━━━━━━ 7s 89ms/step - accuracy: 0.8746 - loss: 0.3262 16/100 ━━━━━━━━━━━━━━━━━━━━ 7s 89ms/step - accuracy: 0.8754 - loss: 0.3234 17/100 ━━━━━━━━━━━━━━━━━━━━ 7s 88ms/step - accuracy: 0.8761 - loss: 0.3208 18/100 ━━━━━━━━━━━━━━━━━━━━ 7s 88ms/step - accuracy: 0.8770 - loss: 0.3181 19/100 ━━━━━━━━━━━━━━━━━━━━ 7s 87ms/step - accuracy: 0.8778 - loss: 0.3161 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 87ms/step - accuracy: 0.8786 - loss: 0.3141 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 87ms/step - accuracy: 0.8795 - loss: 0.3120 22/100 ━━━━━━━━━━━━━━━━━━━━ 6s 86ms/step - accuracy: 0.8803 - loss: 0.3100 23/100 ━━━━━━━━━━━━━━━━━━━━ 6s 86ms/step - accuracy: 0.8808 - loss: 0.3085 24/100 ━━━━━━━━━━━━━━━━━━━━ 6s 86ms/step - accuracy: 0.8814 - loss: 0.3072 25/100 ━━━━━━━━━━━━━━━━━━━━ 6s 85ms/step - accuracy: 0.8817 - loss: 0.3064 26/100 ━━━━━━━━━━━━━━━━━━━━ 6s 85ms/step - accuracy: 0.8819 - loss: 0.3059 27/100 ━━━━━━━━━━━━━━━━━━━━ 6s 86ms/step - accuracy: 0.8822 - loss: 0.3052 28/100 ━━━━━━━━━━━━━━━━━━━━ 6s 85ms/step - accuracy: 0.8823 - loss: 0.3047 29/100 ━━━━━━━━━━━━━━━━━━━━ 6s 85ms/step - accuracy: 0.8824 - loss: 0.3042 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 85ms/step - accuracy: 0.8825 - loss: 0.3037 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 85ms/step - accuracy: 0.8826 - loss: 0.3033 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 85ms/step - accuracy: 0.8827 - loss: 0.3029 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8827 - loss: 0.3025 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8828 - loss: 0.3021 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8828 - loss: 0.3017 36/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8829 - loss: 0.3012 37/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8830 - loss: 0.3007 38/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8830 - loss: 0.3003 39/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.8829 - loss: 0.3002 40/100 ━━━━━━━━━━━━━━━━━━━━ 5s 83ms/step - accuracy: 0.8827 - loss: 0.3002 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8826 - loss: 0.3002 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8824 - loss: 0.3002 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8822 - loss: 0.3003 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8821 - loss: 0.3003 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8819 - loss: 0.3004 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8817 - loss: 0.3005 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8815 - loss: 0.3005 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8814 - loss: 0.3005 49/100 ━━━━━━━━━━━━━━━━━━━━ 4s 83ms/step - accuracy: 0.8813 - loss: 0.3005 50/100 ━━━━━━━━━━━━━━━━━━━━ 4s 82ms/step - accuracy: 0.8812 - loss: 0.3004 51/100 ━━━━━━━━━━━━━━━━━━━━ 4s 82ms/step - accuracy: 0.8812 - loss: 0.3002 52/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8812 - loss: 0.3001 53/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8812 - loss: 0.3000 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8812 - loss: 0.2998 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2996 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2995 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2994 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2994 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2994 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2993 61/100 ━━━━━━━━━━━━━━━━━━━━ 3s 82ms/step - accuracy: 0.8813 - loss: 0.2993 62/100 ━━━━━━━━━━━━━━━━━━━━ 3s 81ms/step - accuracy: 0.8812 - loss: 0.2994 63/100 ━━━━━━━━━━━━━━━━━━━━ 3s 81ms/step - accuracy: 0.8811 - loss: 0.2995 64/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8809 - loss: 0.2996 65/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8808 - loss: 0.2996 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8807 - loss: 0.2997 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8806 - loss: 0.2998 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8806 - loss: 0.2999 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8805 - loss: 0.3000 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8804 - loss: 0.3000 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8803 - loss: 0.3001 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8802 - loss: 0.3002 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8802 - loss: 0.3001 74/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8801 - loss: 0.3002 75/100 ━━━━━━━━━━━━━━━━━━━━ 2s 81ms/step - accuracy: 0.8801 - loss: 0.3002 76/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8800 - loss: 0.3002 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8799 - loss: 0.3002 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8798 - loss: 0.3004 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8796 - loss: 0.3006 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8795 - loss: 0.3008 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8793 - loss: 0.3009 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8792 - loss: 0.3011 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8791 - loss: 0.3013 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8790 - loss: 0.3014 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8789 - loss: 0.3016 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8788 - loss: 0.3017 87/100 ━━━━━━━━━━━━━━━━━━━━ 1s 81ms/step - accuracy: 0.8788 - loss: 0.3018 88/100 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.8787 - loss: 0.3019 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.8786 - loss: 0.3021 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.8785 - loss: 0.3022 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.8784 - loss: 0.3023 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 81ms/step - accuracy: 0.8783 - loss: 0.3024 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8782 - loss: 0.3025 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8782 - loss: 0.3026 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8781 - loss: 0.3027 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8781 - loss: 0.3027 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8780 - loss: 0.3028 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8779 - loss: 0.3029 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8778 - loss: 0.3030100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 80ms/step - accuracy: 0.8778 - loss: 0.3032100/100 ━━━━━━━━━━━━━━━━━━━━ 9s 93ms/step - accuracy: 0.8777 - loss: 0.3033 - val_accuracy: 0.7310 - val_loss: 0.5456
Epoch 8/8
  1/100 ━━━━━━━━━━━━━━━━━━━━ 24s 246ms/step - accuracy: 0.9500 - loss: 0.1664  2/100 ━━━━━━━━━━━━━━━━━━━━ 7s 74ms/step - accuracy: 0.9500 - loss: 0.1794    3/100 ━━━━━━━━━━━━━━━━━━━━ 7s 74ms/step - accuracy: 0.9500 - loss: 0.1807  4/100 ━━━━━━━━━━━━━━━━━━━━ 7s 74ms/step - accuracy: 0.9438 - loss: 0.1843  5/100 ━━━━━━━━━━━━━━━━━━━━ 7s 74ms/step - accuracy: 0.9370 - loss: 0.1904  6/100 ━━━━━━━━━━━━━━━━━━━━ 7s 75ms/step - accuracy: 0.9350 - loss: 0.1926  7/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9331 - loss: 0.1948  8/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9313 - loss: 0.1972  9/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9303 - loss: 0.1986 10/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9302 - loss: 0.1990 11/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9300 - loss: 0.2006 12/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9303 - loss: 0.2014 13/100 ━━━━━━━━━━━━━━━━━━━━ 6s 75ms/step - accuracy: 0.9306 - loss: 0.2018 14/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9312 - loss: 0.2016 15/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9318 - loss: 0.2015 16/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9320 - loss: 0.2017 17/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9318 - loss: 0.2019 18/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9314 - loss: 0.2021 19/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9310 - loss: 0.2025 20/100 ━━━━━━━━━━━━━━━━━━━━ 6s 76ms/step - accuracy: 0.9308 - loss: 0.2026 21/100 ━━━━━━━━━━━━━━━━━━━━ 6s 77ms/step - accuracy: 0.9307 - loss: 0.2027 22/100 ━━━━━━━━━━━━━━━━━━━━ 6s 78ms/step - accuracy: 0.9308 - loss: 0.2025 23/100 ━━━━━━━━━━━━━━━━━━━━ 6s 79ms/step - accuracy: 0.9306 - loss: 0.2027 24/100 ━━━━━━━━━━━━━━━━━━━━ 6s 80ms/step - accuracy: 0.9300 - loss: 0.2033 25/100 ━━━━━━━━━━━━━━━━━━━━ 6s 81ms/step - accuracy: 0.9295 - loss: 0.2037 26/100 ━━━━━━━━━━━━━━━━━━━━ 6s 81ms/step - accuracy: 0.9291 - loss: 0.2042 27/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9287 - loss: 0.2045 28/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9283 - loss: 0.2049 29/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9280 - loss: 0.2052 30/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9278 - loss: 0.2055 31/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9275 - loss: 0.2056 32/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9274 - loss: 0.2057 33/100 ━━━━━━━━━━━━━━━━━━━━ 5s 82ms/step - accuracy: 0.9272 - loss: 0.2057 34/100 ━━━━━━━━━━━━━━━━━━━━ 5s 83ms/step - accuracy: 0.9271 - loss: 0.2056 35/100 ━━━━━━━━━━━━━━━━━━━━ 5s 83ms/step - accuracy: 0.9269 - loss: 0.2057 36/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.9267 - loss: 0.2058 37/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.9266 - loss: 0.2058 38/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.9265 - loss: 0.2058 39/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.9264 - loss: 0.2057 40/100 ━━━━━━━━━━━━━━━━━━━━ 5s 84ms/step - accuracy: 0.9264 - loss: 0.2056 41/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9263 - loss: 0.2055 42/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9261 - loss: 0.2057 43/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9259 - loss: 0.2059 44/100 ━━━━━━━━━━━━━━━━━━━━ 4s 84ms/step - accuracy: 0.9257 - loss: 0.2061 45/100 ━━━━━━━━━━━━━━━━━━━━ 4s 84ms/step - accuracy: 0.9255 - loss: 0.2063 46/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9253 - loss: 0.2065 47/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9251 - loss: 0.2066 48/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9249 - loss: 0.2068 49/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9247 - loss: 0.2070 50/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9244 - loss: 0.2072 51/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9242 - loss: 0.2074 52/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9240 - loss: 0.2075 53/100 ━━━━━━━━━━━━━━━━━━━━ 4s 85ms/step - accuracy: 0.9238 - loss: 0.2077 54/100 ━━━━━━━━━━━━━━━━━━━━ 3s 85ms/step - accuracy: 0.9235 - loss: 0.2080 55/100 ━━━━━━━━━━━━━━━━━━━━ 3s 85ms/step - accuracy: 0.9232 - loss: 0.2085 56/100 ━━━━━━━━━━━━━━━━━━━━ 3s 85ms/step - accuracy: 0.9229 - loss: 0.2089 57/100 ━━━━━━━━━━━━━━━━━━━━ 3s 85ms/step - accuracy: 0.9226 - loss: 0.2092 58/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9224 - loss: 0.2096 59/100 ━━━━━━━━━━━━━━━━━━━━ 3s 88ms/step - accuracy: 0.9222 - loss: 0.2099 60/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9219 - loss: 0.2102 61/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9217 - loss: 0.2105 62/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9215 - loss: 0.2108 63/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9213 - loss: 0.2110 64/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9211 - loss: 0.2113 65/100 ━━━━━━━━━━━━━━━━━━━━ 3s 87ms/step - accuracy: 0.9209 - loss: 0.2115 66/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9207 - loss: 0.2117 67/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9206 - loss: 0.2119 68/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9204 - loss: 0.2121 69/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9202 - loss: 0.2123 70/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9200 - loss: 0.2125 71/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9199 - loss: 0.2127 72/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9197 - loss: 0.2129 73/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9196 - loss: 0.2130 74/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9195 - loss: 0.2132 75/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9193 - loss: 0.2134 76/100 ━━━━━━━━━━━━━━━━━━━━ 2s 87ms/step - accuracy: 0.9192 - loss: 0.2135 77/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9191 - loss: 0.2137 78/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9189 - loss: 0.2138 79/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9188 - loss: 0.2140 80/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9186 - loss: 0.2142 81/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9185 - loss: 0.2144 82/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9184 - loss: 0.2146 83/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9183 - loss: 0.2147 84/100 ━━━━━━━━━━━━━━━━━━━━ 1s 87ms/step - accuracy: 0.9182 - loss: 0.2149 85/100 ━━━━━━━━━━━━━━━━━━━━ 1s 86ms/step - accuracy: 0.9181 - loss: 0.2150 86/100 ━━━━━━━━━━━━━━━━━━━━ 1s 86ms/step - accuracy: 0.9180 - loss: 0.2152 87/100 ━━━━━━━━━━━━━━━━━━━━ 1s 86ms/step - accuracy: 0.9179 - loss: 0.2153 88/100 ━━━━━━━━━━━━━━━━━━━━ 1s 86ms/step - accuracy: 0.9178 - loss: 0.2155 89/100 ━━━━━━━━━━━━━━━━━━━━ 0s 86ms/step - accuracy: 0.9176 - loss: 0.2157 90/100 ━━━━━━━━━━━━━━━━━━━━ 0s 86ms/step - accuracy: 0.9175 - loss: 0.2159 91/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9173 - loss: 0.2162 92/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9172 - loss: 0.2165 93/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9170 - loss: 0.2167 94/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9168 - loss: 0.2170 95/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9166 - loss: 0.2172 96/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9165 - loss: 0.2175 97/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9163 - loss: 0.2177 98/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9162 - loss: 0.2179 99/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9160 - loss: 0.2181100/100 ━━━━━━━━━━━━━━━━━━━━ 0s 88ms/step - accuracy: 0.9159 - loss: 0.2183100/100 ━━━━━━━━━━━━━━━━━━━━ 10s 103ms/step - accuracy: 0.9158 - loss: 0.2185 - val_accuracy: 0.7460 - val_loss: 0.6347</code></pre>
</div>
</div>
</section>
<section id="training-result" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> training result</h1>
<div id="03c0eff4" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>acc<span class="op">=</span>history.history[<span class="st">'accuracy'</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>val_acc<span class="op">=</span>history.history[<span class="st">'val_accuracy'</span>]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>loss<span class="op">=</span>history.history[<span class="st">'loss'</span>]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>val_loss<span class="op">=</span>history.history[<span class="st">'val_loss'</span>]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="bu">range</span>(<span class="bu">len</span>(acc)) <span class="co"># Get number of epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d56c2ebb" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation accuracy per epoch</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation accuracy per epoch</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, acc, <span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Training accuracy'</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, val_acc, <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation accuracy'</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training and validation accuracy'</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, loss, <span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Training Loss'</span>)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, val_loss, <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation Loss'</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training and validation loss'</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="c2week1_files/figure-html/cell-18-output-1.png" width="579" height="431" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="c2week1_files/figure-html/cell-18-output-2.png" width="571" height="431" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="prediction" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Prediction</h1>
<p>Prediction from train</p>
<div id="f85a9e17" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> load_img, img_to_array</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>fn<span class="op">=</span><span class="st">'dog.7.jpg'</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">'./tmp/cats_and_dogs_filtered/train/dogs/'</span><span class="op">+</span> fn</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> load_img(path, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> img_to_array(img)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> <span class="dv">255</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> np.vstack([x])</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> model.predict(images, batch_size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classes[<span class="dv">0</span>])</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> classes[<span class="dv">0</span>]<span class="op">&gt;</span><span class="fl">0.5</span>:</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a dog"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a cat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 37ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 37ms/step
[0.9826543]
dog.7.jpg is a dog</code></pre>
</div>
</div>
<p>Prediction from internet</p>
<div id="88712ca1" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> load_img, img_to_array</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>fn<span class="op">=</span><span class="st">'dog-puppy.jpg'</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">'./random/'</span><span class="op">+</span> fn</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> load_img(path, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> img_to_array(img)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> <span class="dv">255</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> np.vstack([x])</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> model.predict(images, batch_size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classes[<span class="dv">0</span>])</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> classes[<span class="dv">0</span>]<span class="op">&gt;</span><span class="fl">0.5</span>:</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a dog"</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a cat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 13ms/step1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 13ms/step
[0.9283971]
dog-puppy.jpg is a dog</code></pre>
</div>
</div>
</section>
<section id="resource" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> resource:</h1>
<p>https://coursera.org/learn/convolutional-neural-networks-tensorflow/home/</p>
<p>https://github.com/https-deeplearning-ai/tensorflow-1-public/tree/main/C2</p>
<p>https://www.kaggle.com/c/dogs-vs-cats</p>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb29" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "W1:Exploring a Larger Dataset"</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-bg: true</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>Week1 Exploring a Larger Dataset</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>In the first course in this specialization, you had an introduction to TensorFlow, and how, with its high level APIs you could do basic image classification, an you learned a little bit about Convolutional Neural Networks (ConvNets). In this course you'll go deeper into using ConvNets will real-world data, and learn about techniques that you can use to improve your ConvNet performance, particularly when doing image classification!</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>In Week 1, this week, you'll get started by looking at a much larger dataset than you've been using thus far: The Cats and Dogs dataset which had been a Kaggle Challenge in image classification!</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># download data</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a><span class="fu">## download small cats_and_dogs_filtered.zip which have train and validation folder</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> urllib.request</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(<span class="st">"https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip"</span>, <span class="st">"cats_and_dogs_filtered.zip"</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> zipfile</span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the archive</span></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>local_zip <span class="op">=</span> <span class="st">'./cats_and_dogs_filtered.zip'</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>zip_ref <span class="op">=</span> zipfile.ZipFile(local_zip, <span class="st">'r'</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>zip_ref.extractall()</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>zip_ref.close()</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> Image.<span class="bu">open</span>(<span class="st">'./tmp/cats_and_dogs_filtered/train/cats/cat.0.jpg'</span>)</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>im.size <span class="co"># (width,height) </span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>base_dir <span class="op">=</span> <span class="st">'./tmp/cats_and_dogs_filtered'</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Contents of base directory:"</span>)</span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(base_dir))</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Contents of train directory:"</span>)</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(<span class="ss">f'</span><span class="sc">{</span>base_dir<span class="sc">}</span><span class="ss">/train'</span>))</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Contents of validation directory:"</span>)</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(os.listdir(<span class="ss">f'</span><span class="sc">{</span>base_dir<span class="sc">}</span><span class="ss">/validation'</span>))</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>train_dir <span class="op">=</span> os.path.join(base_dir, <span class="st">'train'</span>)</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>validation_dir <span class="op">=</span> os.path.join(base_dir, <span class="st">'validation'</span>)</span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory with training cat/dog pictures</span></span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>train_cats_dir <span class="op">=</span> os.path.join(train_dir, <span class="st">'cats'</span>)</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>train_dogs_dir <span class="op">=</span> os.path.join(train_dir, <span class="st">'dogs'</span>)</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory with validation cat/dog pictures</span></span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>validation_cats_dir <span class="op">=</span> os.path.join(validation_dir, <span class="st">'cats'</span>)</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>validation_dogs_dir <span class="op">=</span> os.path.join(validation_dir, <span class="st">'dogs'</span>)</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>train_cat_fnames <span class="op">=</span> os.listdir( train_cats_dir )</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>train_dog_fnames <span class="op">=</span> os.listdir( train_dogs_dir )</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_cat_fnames[:<span class="dv">10</span>])</span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_dog_fnames[:<span class="dv">10</span>])</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total training cat images :'</span>, <span class="bu">len</span>(os.listdir(      train_cats_dir ) ))</span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total training dog images :'</span>, <span class="bu">len</span>(os.listdir(      train_dogs_dir ) ))</span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total validation cat images :'</span>, <span class="bu">len</span>(os.listdir( validation_cats_dir ) ))</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'total validation dog images :'</span>, <span class="bu">len</span>(os.listdir( validation_dogs_dir ) ))</span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters for our graph; we'll output images in a 4x4 configuration</span></span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a>nrows <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>ncols <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>pic_index <span class="op">=</span> <span class="dv">0</span> <span class="co"># Index for iterating over images</span></span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up matplotlib fig, and size it to fit 4x4 pics</span></span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.gcf()</span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(ncols<span class="op">*</span><span class="dv">4</span>, nrows<span class="op">*</span><span class="dv">4</span>)</span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a>pic_index<span class="op">+=</span><span class="dv">8</span></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>next_cat_pix <span class="op">=</span> [os.path.join(train_cats_dir, fname) </span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_cat_fnames[ pic_index<span class="op">-</span><span class="dv">8</span>:pic_index] </span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>next_dog_pix <span class="op">=</span> [os.path.join(train_dogs_dir, fname) </span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> fname <span class="kw">in</span> train_dog_fnames[ pic_index<span class="op">-</span><span class="dv">8</span>:pic_index]</span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>               ]</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, img_path <span class="kw">in</span> <span class="bu">enumerate</span>(next_cat_pix<span class="op">+</span>next_dog_pix):</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set up subplot; subplot indices start at 1</span></span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>  sp <span class="op">=</span> plt.subplot(nrows, ncols, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>  sp.axis(<span class="st">'Off'</span>) <span class="co"># Don't show axes (or gridlines)</span></span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a>  img <span class="op">=</span> mpimg.imread(img_path)</span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>  plt.imshow(img)</span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow <span class="im">import</span> keras</span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tf.__version__)</span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-157"><a href="#cb29-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-158"><a href="#cb29-158" aria-hidden="true" tabindex="-1"></a><span class="fu"># Load the data</span></span>
<span id="cb29-159"><a href="#cb29-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-160"><a href="#cb29-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-161"><a href="#cb29-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-162"><a href="#cb29-162" aria-hidden="true" tabindex="-1"></a>ImageDataGenerator: All images will be resized to 150x150</span>
<span id="cb29-163"><a href="#cb29-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-166"><a href="#cb29-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-167"><a href="#cb29-167" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.image <span class="im">import</span> ImageDataGenerator</span>
<span id="cb29-168"><a href="#cb29-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-169"><a href="#cb29-169" aria-hidden="true" tabindex="-1"></a><span class="co"># All images will be rescaled by 1./255.</span></span>
<span id="cb29-170"><a href="#cb29-170" aria-hidden="true" tabindex="-1"></a>train_datagen <span class="op">=</span> ImageDataGenerator( rescale <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span><span class="fl">255.</span> )</span>
<span id="cb29-171"><a href="#cb29-171" aria-hidden="true" tabindex="-1"></a>test_datagen  <span class="op">=</span> ImageDataGenerator( rescale <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span><span class="fl">255.</span> )</span>
<span id="cb29-172"><a href="#cb29-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-173"><a href="#cb29-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-174"><a href="#cb29-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-175"><a href="#cb29-175" aria-hidden="true" tabindex="-1"></a>Image Data from directory</span>
<span id="cb29-178"><a href="#cb29-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-179"><a href="#cb29-179" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb29-180"><a href="#cb29-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Flow training images in batches of 20 using train_datagen generator</span></span>
<span id="cb29-181"><a href="#cb29-181" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb29-182"><a href="#cb29-182" aria-hidden="true" tabindex="-1"></a>train_generator <span class="op">=</span> train_datagen.flow_from_directory(train_dir,</span>
<span id="cb29-183"><a href="#cb29-183" aria-hidden="true" tabindex="-1"></a>                                                    batch_size<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb29-184"><a href="#cb29-184" aria-hidden="true" tabindex="-1"></a>                                                    class_mode<span class="op">=</span><span class="st">'binary'</span>,</span>
<span id="cb29-185"><a href="#cb29-185" aria-hidden="true" tabindex="-1"></a>                                                    target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))     </span>
<span id="cb29-186"><a href="#cb29-186" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb29-187"><a href="#cb29-187" aria-hidden="true" tabindex="-1"></a><span class="co"># Flow validation images in batches of 20 using test_datagen generator</span></span>
<span id="cb29-188"><a href="#cb29-188" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------</span></span>
<span id="cb29-189"><a href="#cb29-189" aria-hidden="true" tabindex="-1"></a>validation_generator <span class="op">=</span>  test_datagen.flow_from_directory(validation_dir,</span>
<span id="cb29-190"><a href="#cb29-190" aria-hidden="true" tabindex="-1"></a>                                                         batch_size<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb29-191"><a href="#cb29-191" aria-hidden="true" tabindex="-1"></a>                                                         class_mode  <span class="op">=</span> <span class="st">'binary'</span>,</span>
<span id="cb29-192"><a href="#cb29-192" aria-hidden="true" tabindex="-1"></a>                                                         target_size <span class="op">=</span> (<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb29-193"><a href="#cb29-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-194"><a href="#cb29-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-195"><a href="#cb29-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-196"><a href="#cb29-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-197"><a href="#cb29-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-198"><a href="#cb29-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-199"><a href="#cb29-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-200"><a href="#cb29-200" aria-hidden="true" tabindex="-1"></a><span class="fu"># define convolutional model</span></span>
<span id="cb29-201"><a href="#cb29-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-202"><a href="#cb29-202" aria-hidden="true" tabindex="-1"></a>input 150 by 150 color image</span>
<span id="cb29-203"><a href="#cb29-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-204"><a href="#cb29-204" aria-hidden="true" tabindex="-1"></a>flow into 16 3by3 convolutional layers and 2by2 pooling</span>
<span id="cb29-205"><a href="#cb29-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-206"><a href="#cb29-206" aria-hidden="true" tabindex="-1"></a>output is 1 neural(0/1) sigmoid function.its good for binary</span>
<span id="cb29-207"><a href="#cb29-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-210"><a href="#cb29-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-211"><a href="#cb29-211" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb29-212"><a href="#cb29-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-213"><a href="#cb29-213" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> tf.keras.models.Sequential([</span>
<span id="cb29-214"><a href="#cb29-214" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note the input shape is the desired size of the image 150x150 with 3 bytes color</span></span>
<span id="cb29-215"><a href="#cb29-215" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">16</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>, input_shape<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>, <span class="dv">3</span>)),</span>
<span id="cb29-216"><a href="#cb29-216" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb29-217"><a href="#cb29-217" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">32</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb29-218"><a href="#cb29-218" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>), </span>
<span id="cb29-219"><a href="#cb29-219" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Conv2D(<span class="dv">64</span>, (<span class="dv">3</span>,<span class="dv">3</span>), activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb29-220"><a href="#cb29-220" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.MaxPooling2D(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb29-221"><a href="#cb29-221" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flatten the results to feed into a DNN</span></span>
<span id="cb29-222"><a href="#cb29-222" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Flatten(), </span>
<span id="cb29-223"><a href="#cb29-223" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 512 neuron hidden layer</span></span>
<span id="cb29-224"><a href="#cb29-224" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">512</span>, activation<span class="op">=</span><span class="st">'relu'</span>), </span>
<span id="cb29-225"><a href="#cb29-225" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only 1 output neuron. It will contain a value from 0-1 where 0 for 1 class ('cats') and 1 for the other ('dogs')</span></span>
<span id="cb29-226"><a href="#cb29-226" aria-hidden="true" tabindex="-1"></a>    tf.keras.layers.Dense(<span class="dv">1</span>, activation<span class="op">=</span><span class="st">'sigmoid'</span>)  </span>
<span id="cb29-227"><a href="#cb29-227" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb29-228"><a href="#cb29-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-229"><a href="#cb29-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-232"><a href="#cb29-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-233"><a href="#cb29-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb29-234"><a href="#cb29-234" aria-hidden="true" tabindex="-1"></a>model.summary()</span>
<span id="cb29-235"><a href="#cb29-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-236"><a href="#cb29-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-237"><a href="#cb29-237" aria-hidden="true" tabindex="-1"></a><span class="fu"># compile model</span></span>
<span id="cb29-238"><a href="#cb29-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-241"><a href="#cb29-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-242"><a href="#cb29-242" aria-hidden="true" tabindex="-1"></a><span class="co"># v2.11+ optimizer `tf.keras.optimizers.RMSprop` runs slowly on M1/M2 Macs</span></span>
<span id="cb29-243"><a href="#cb29-243" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.optimizers <span class="im">import</span> RMSprop</span>
<span id="cb29-244"><a href="#cb29-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-245"><a href="#cb29-245" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'binary_crossentropy'</span>,</span>
<span id="cb29-246"><a href="#cb29-246" aria-hidden="true" tabindex="-1"></a>              optimizer<span class="op">=</span>RMSprop(learning_rate<span class="op">=</span><span class="fl">0.001</span>),</span>
<span id="cb29-247"><a href="#cb29-247" aria-hidden="true" tabindex="-1"></a>              metrics<span class="op">=</span>[<span class="st">'accuracy'</span>])</span>
<span id="cb29-248"><a href="#cb29-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-249"><a href="#cb29-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-250"><a href="#cb29-250" aria-hidden="true" tabindex="-1"></a><span class="fu"># Callbacks</span></span>
<span id="cb29-251"><a href="#cb29-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-254"><a href="#cb29-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-255"><a href="#cb29-255" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> myCallback(tf.keras.callbacks.Callback):</span>
<span id="cb29-256"><a href="#cb29-256" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> on_epoch_end(<span class="va">self</span>, epoch, logs<span class="op">=</span>{}):</span>
<span id="cb29-257"><a href="#cb29-257" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb29-258"><a href="#cb29-258" aria-hidden="true" tabindex="-1"></a><span class="co">    Halts the training when the loss falls below 0.15</span></span>
<span id="cb29-259"><a href="#cb29-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-260"><a href="#cb29-260" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb29-261"><a href="#cb29-261" aria-hidden="true" tabindex="-1"></a><span class="co">      epoch (integer) - index of epoch (required but unused in the function definition below)</span></span>
<span id="cb29-262"><a href="#cb29-262" aria-hidden="true" tabindex="-1"></a><span class="co">      logs (dict) - metric results from the training epoch</span></span>
<span id="cb29-263"><a href="#cb29-263" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb29-264"><a href="#cb29-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-265"><a href="#cb29-265" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check the loss</span></span>
<span id="cb29-266"><a href="#cb29-266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(logs.get(<span class="st">'loss'</span>) <span class="op">&lt;</span> <span class="fl">0.15</span>):</span>
<span id="cb29-267"><a href="#cb29-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-268"><a href="#cb29-268" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Stop if threshold is met</span></span>
<span id="cb29-269"><a href="#cb29-269" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Loss is lower than 0.2 so cancelling training!"</span>)</span>
<span id="cb29-270"><a href="#cb29-270" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">"cancelling training with:"</span>)</span>
<span id="cb29-271"><a href="#cb29-271" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(epoch<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb29-272"><a href="#cb29-272" aria-hidden="true" tabindex="-1"></a>      <span class="va">self</span>.model.stop_training <span class="op">=</span> <span class="va">True</span></span>
<span id="cb29-273"><a href="#cb29-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-274"><a href="#cb29-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate class</span></span>
<span id="cb29-275"><a href="#cb29-275" aria-hidden="true" tabindex="-1"></a>callbacks <span class="op">=</span> myCallback()</span>
<span id="cb29-276"><a href="#cb29-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-277"><a href="#cb29-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-278"><a href="#cb29-278" aria-hidden="true" tabindex="-1"></a><span class="fu"># train model</span></span>
<span id="cb29-279"><a href="#cb29-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-282"><a href="#cb29-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-283"><a href="#cb29-283" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb29-284"><a href="#cb29-284" aria-hidden="true" tabindex="-1"></a>            train_generator,</span>
<span id="cb29-285"><a href="#cb29-285" aria-hidden="true" tabindex="-1"></a>            epochs<span class="op">=</span><span class="dv">8</span>,</span>
<span id="cb29-286"><a href="#cb29-286" aria-hidden="true" tabindex="-1"></a>            validation_data<span class="op">=</span>validation_generator,</span>
<span id="cb29-287"><a href="#cb29-287" aria-hidden="true" tabindex="-1"></a>            callbacks<span class="op">=</span>[callbacks]</span>
<span id="cb29-288"><a href="#cb29-288" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb29-289"><a href="#cb29-289" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-290"><a href="#cb29-290" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-291"><a href="#cb29-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-292"><a href="#cb29-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-293"><a href="#cb29-293" aria-hidden="true" tabindex="-1"></a><span class="fu"># training result</span></span>
<span id="cb29-296"><a href="#cb29-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-297"><a href="#cb29-297" aria-hidden="true" tabindex="-1"></a>acc<span class="op">=</span>history.history[<span class="st">'accuracy'</span>]</span>
<span id="cb29-298"><a href="#cb29-298" aria-hidden="true" tabindex="-1"></a>val_acc<span class="op">=</span>history.history[<span class="st">'val_accuracy'</span>]</span>
<span id="cb29-299"><a href="#cb29-299" aria-hidden="true" tabindex="-1"></a>loss<span class="op">=</span>history.history[<span class="st">'loss'</span>]</span>
<span id="cb29-300"><a href="#cb29-300" aria-hidden="true" tabindex="-1"></a>val_loss<span class="op">=</span>history.history[<span class="st">'val_loss'</span>]</span>
<span id="cb29-301"><a href="#cb29-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-302"><a href="#cb29-302" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="bu">range</span>(<span class="bu">len</span>(acc)) <span class="co"># Get number of epochs</span></span>
<span id="cb29-303"><a href="#cb29-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-304"><a href="#cb29-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-307"><a href="#cb29-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-308"><a href="#cb29-308" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-309"><a href="#cb29-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation accuracy per epoch</span></span>
<span id="cb29-310"><a href="#cb29-310" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-311"><a href="#cb29-311" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.image <span class="im">as</span> mpimg</span>
<span id="cb29-312"><a href="#cb29-312" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb29-313"><a href="#cb29-313" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-314"><a href="#cb29-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot training and validation accuracy per epoch</span></span>
<span id="cb29-315"><a href="#cb29-315" aria-hidden="true" tabindex="-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb29-316"><a href="#cb29-316" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, acc, <span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Training accuracy'</span>)</span>
<span id="cb29-317"><a href="#cb29-317" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, val_acc, <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation accuracy'</span>)</span>
<span id="cb29-318"><a href="#cb29-318" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training and validation accuracy'</span>)</span>
<span id="cb29-319"><a href="#cb29-319" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb29-320"><a href="#cb29-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-321"><a href="#cb29-321" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb29-322"><a href="#cb29-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-323"><a href="#cb29-323" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, loss, <span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Training Loss'</span>)</span>
<span id="cb29-324"><a href="#cb29-324" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs, val_loss, <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation Loss'</span>)</span>
<span id="cb29-325"><a href="#cb29-325" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Training and validation loss'</span>)</span>
<span id="cb29-326"><a href="#cb29-326" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb29-327"><a href="#cb29-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-328"><a href="#cb29-328" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb29-329"><a href="#cb29-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-330"><a href="#cb29-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-331"><a href="#cb29-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-332"><a href="#cb29-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-333"><a href="#cb29-333" aria-hidden="true" tabindex="-1"></a><span class="fu"># Prediction</span></span>
<span id="cb29-334"><a href="#cb29-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-335"><a href="#cb29-335" aria-hidden="true" tabindex="-1"></a>Prediction from train </span>
<span id="cb29-336"><a href="#cb29-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-339"><a href="#cb29-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-340"><a href="#cb29-340" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-341"><a href="#cb29-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-342"><a href="#cb29-342" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> load_img, img_to_array</span>
<span id="cb29-343"><a href="#cb29-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-344"><a href="#cb29-344" aria-hidden="true" tabindex="-1"></a>fn<span class="op">=</span><span class="st">'dog.7.jpg'</span></span>
<span id="cb29-345"><a href="#cb29-345" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">'./tmp/cats_and_dogs_filtered/train/dogs/'</span><span class="op">+</span> fn</span>
<span id="cb29-346"><a href="#cb29-346" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> load_img(path, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb29-347"><a href="#cb29-347" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> img_to_array(img)</span>
<span id="cb29-348"><a href="#cb29-348" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> <span class="dv">255</span></span>
<span id="cb29-349"><a href="#cb29-349" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-350"><a href="#cb29-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-351"><a href="#cb29-351" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> np.vstack([x])</span>
<span id="cb29-352"><a href="#cb29-352" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> model.predict(images, batch_size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb29-353"><a href="#cb29-353" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classes[<span class="dv">0</span>])</span>
<span id="cb29-354"><a href="#cb29-354" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> classes[<span class="dv">0</span>]<span class="op">&gt;</span><span class="fl">0.5</span>:</span>
<span id="cb29-355"><a href="#cb29-355" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a dog"</span>)</span>
<span id="cb29-356"><a href="#cb29-356" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb29-357"><a href="#cb29-357" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a cat"</span>)</span>
<span id="cb29-358"><a href="#cb29-358" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb29-359"><a href="#cb29-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-360"><a href="#cb29-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-361"><a href="#cb29-361" aria-hidden="true" tabindex="-1"></a>Prediction from internet</span>
<span id="cb29-362"><a href="#cb29-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-365"><a href="#cb29-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-366"><a href="#cb29-366" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-367"><a href="#cb29-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-368"><a href="#cb29-368" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.utils <span class="im">import</span> load_img, img_to_array</span>
<span id="cb29-369"><a href="#cb29-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-370"><a href="#cb29-370" aria-hidden="true" tabindex="-1"></a>fn<span class="op">=</span><span class="st">'dog-puppy.jpg'</span></span>
<span id="cb29-371"><a href="#cb29-371" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">'./random/'</span><span class="op">+</span> fn</span>
<span id="cb29-372"><a href="#cb29-372" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> load_img(path, target_size<span class="op">=</span>(<span class="dv">150</span>, <span class="dv">150</span>))</span>
<span id="cb29-373"><a href="#cb29-373" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> img_to_array(img)</span>
<span id="cb29-374"><a href="#cb29-374" aria-hidden="true" tabindex="-1"></a>x <span class="op">/=</span> <span class="dv">255</span></span>
<span id="cb29-375"><a href="#cb29-375" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-376"><a href="#cb29-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-377"><a href="#cb29-377" aria-hidden="true" tabindex="-1"></a>images <span class="op">=</span> np.vstack([x])</span>
<span id="cb29-378"><a href="#cb29-378" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> model.predict(images, batch_size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb29-379"><a href="#cb29-379" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classes[<span class="dv">0</span>])</span>
<span id="cb29-380"><a href="#cb29-380" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> classes[<span class="dv">0</span>]<span class="op">&gt;</span><span class="fl">0.5</span>:</span>
<span id="cb29-381"><a href="#cb29-381" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a dog"</span>)</span>
<span id="cb29-382"><a href="#cb29-382" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb29-383"><a href="#cb29-383" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(fn<span class="op">+</span><span class="st">" is a cat"</span>)</span>
<span id="cb29-384"><a href="#cb29-384" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb29-385"><a href="#cb29-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb29-386"><a href="#cb29-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-387"><a href="#cb29-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-388"><a href="#cb29-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-389"><a href="#cb29-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-390"><a href="#cb29-390" aria-hidden="true" tabindex="-1"></a><span class="fu"># resource:</span></span>
<span id="cb29-391"><a href="#cb29-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-392"><a href="#cb29-392" aria-hidden="true" tabindex="-1"></a>https://coursera.org/learn/convolutional-neural-networks-tensorflow/home/</span>
<span id="cb29-393"><a href="#cb29-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-394"><a href="#cb29-394" aria-hidden="true" tabindex="-1"></a>https://github.com/https-deeplearning-ai/tensorflow-1-public/tree/main/C2</span>
<span id="cb29-395"><a href="#cb29-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-396"><a href="#cb29-396" aria-hidden="true" tabindex="-1"></a>https://www.kaggle.com/c/dogs-vs-cats</span>
<span id="cb29-397"><a href="#cb29-397" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>